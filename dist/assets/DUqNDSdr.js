const o=r=>Math.floor(100*Math.pow(1.5,r-1)),_=r=>{let t=1,a=o(t),e=r;for(;e>=a;)e-=a,t++,a=o(t);return{level:t,currentXp:e,xpToNext:a}},h=r=>r>=1e4?"legend":r>=5e3?"diamond":r>=2500?"platinum":r>=1e3?"gold":r>=500?"silver":"bronze",v=[{id:"first_victory",name:"Première Victoire",description:"Gagne ta première partie",image:"/images/achievements/Achiev_Premiere_Victoire.png",target:1},{id:"10_victories",name:"10 Victoires",description:"Gagne 10 parties",image:"/images/achievements/Achiev_10_Victoires.png",target:10},{id:"100_questions",name:"100 Questions",description:"Réponds à 100 questions",image:"/images/achievements/Achiev_100_Questions.png",target:100},{id:"perfect_series",name:"Série Parfaite",description:"10 bonnes réponses consécutives",image:"/images/achievements/Achiev_Serie_Parfaite.png",target:10},{id:"quiz_master",name:"Quiz Master",description:"Atteins 90% de précision sur 50 questions",image:"/images/achievements/Achiev_Premiere_Victoire.png",target:50},{id:"speed_demon",name:"Speed Demon",description:"Réponds en moins de 3 secondes 20 fois",image:"/images/achievements/Achiev_10_Victoires.png",target:20},{id:"category_expert",name:"Expert Catégorie",description:"Atteins 100% sur une catégorie (10 questions)",image:"/images/achievements/Achiev_100_Questions.png",target:1},{id:"social_butterfly",name:"Papillon Social",description:"Joue 5 duels contre des amis",image:"/images/achievements/Achiev_Serie_Parfaite.png",target:5}],g=[{id:"PM",name:"Prodigy Master"},{id:"QK",name:"Quiz King"},{id:"BS",name:"Brain Storm"},{id:"QN",name:"Quiz Ninja"},{id:"MR",name:"Mind Reader"},{id:"GN",name:"Genius"},{id:"WZ",name:"Wizard"},{id:"CH",name:"Champion"}],d=["from-violet-600 to-fuchsia-600","from-cyan-500 to-blue-600","from-green-500 to-emerald-600","from-orange-500 to-red-600","from-pink-500 to-rose-600","from-indigo-500 to-purple-600","from-yellow-500 to-amber-600","from-teal-500 to-cyan-600"],A=r=>{const t=g[Math.floor(Math.random()*g.length)],a=d[Math.floor(Math.random()*d.length)],e=v.map(s=>({...s,unlocked:!1,progress:0}));return{id:`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,username:r,avatar:t.id,avatarColor:a,level:1,xp:0,xpToNextLevel:o(1),totalXp:0,league:"bronze",leaguePoints:0,stats:{totalGames:0,wins:0,losses:0,draws:0,winRate:0,totalQuestions:0,correctAnswers:0,accuracy:0,bestStreak:0,currentStreak:0,totalPlayTime:0,favoriteCategory:"",categoryStats:{}},achievements:e,createdAt:new Date().toISOString(),lastPlayedAt:new Date().toISOString()}},b=r=>{localStorage.setItem("qquiz_user",JSON.stringify(r))},w=()=>{const r=localStorage.getItem("qquiz_user");if(!r)return null;try{return JSON.parse(r)}catch{return null}},k=(r,t)=>{const a={...r},e={...a.stats};e.totalGames++,e.totalQuestions+=t.totalQuestions,e.correctAnswers+=t.correctAnswers,e.accuracy=Math.round(e.correctAnswers/e.totalQuestions*100),e.totalPlayTime+=t.timeSpent,t.isWin?(e.wins++,e.currentStreak++,e.currentStreak>e.bestStreak&&(e.bestStreak=e.currentStreak)):(e.losses++,e.currentStreak=0),e.winRate=Math.round(e.wins/e.totalGames*100),e.categoryStats[t.category]||(e.categoryStats[t.category]={played:0,correct:0,accuracy:0,bestScore:0});const s=e.categoryStats[t.category];s.played+=t.totalQuestions,s.correct+=t.correctAnswers,s.accuracy=Math.round(s.correct/s.played*100),t.score>s.bestScore&&(s.bestScore=t.score);let i=0;Object.entries(e.categoryStats).forEach(([S,c])=>{c.played>i&&(i=c.played,e.favoriteCategory=S)}),a.stats=e;const m=t.score/10,l=t.isWin?50:10,u=Math.min(e.currentStreak*5,50),p=Math.floor(m+l+u);a.totalXp+=p;const n=_(a.totalXp);a.level=n.level,a.xp=n.currentXp,a.xpToNextLevel=n.xpToNext;const f=t.isWin?25:t.isDuel?-10:5;return a.leaguePoints=Math.max(0,a.leaguePoints+f),a.league=h(a.leaguePoints),a.achievements=y(a,t),a.lastPlayedAt=new Date().toISOString(),a},y=(r,t)=>r.achievements.map(a=>{if(a.unlocked)return a;let e=a.progress;switch(a.id){case"first_victory":t.isWin&&(e=1);break;case"10_victories":t.isWin&&(e=r.stats.wins);break;case"100_questions":e=r.stats.totalQuestions;break;case"perfect_series":t.correctAnswers===t.totalQuestions&&(e=Math.max(e,t.totalQuestions));break;case"quiz_master":r.stats.accuracy>=90&&r.stats.totalQuestions>=50&&(e=50);break;case"category_expert":t.correctAnswers===t.totalQuestions&&t.totalQuestions>=10&&(e=1);break}const s=e>=a.target;return{...a,progress:e,unlocked:s,unlockedAt:s&&!a.unlocked?new Date().toISOString():a.unlockedAt}}),P=r=>({bronze:"/images/badges/Badge_Bronze.png",silver:"/images/badges/Badge_Argent.png",gold:"/images/badges/Badge_Or.png",platinum:"/images/badges/Badge_Platine.png",diamond:"/images/badges/Badge_Diamant.png",legend:"/images/badges/Badge_Legende.png"})[r],M=r=>({bronze:"Bronze",silver:"Argent",gold:"Or",platinum:"Platine",diamond:"Diamant",legend:"Légende"})[r],Q=r=>{const t=Math.floor(r/3600),a=Math.floor(r%3600/60);return t>0?`${t}h ${a}m`:`${a}m`};export{g as A,M as a,d as b,A as c,Q as f,P as g,w as l,b as s,k as u};
