import{j as e,Z as t,K as a,A as r,m as l,X as s,T as n,F as i,H as c,e as o,B as d,N as m,M as h,q as x,C as u,g as p,f}from"./BDMYgCF_.js";import{u as g,r as b,L as N}from"./DZAFYou2.js";import{B as y}from"./N36WR-16.js";import{u as v}from"./BjEl9CBU.js";import{n as w,f as _,c as j}from"./C9nS5El1.js";import"./BBOF1Dfa.js";function k({post:a,onLike:r,onComment:s}){var c,d,g,N,v;const[w,_]=b.useState(a.is_liked||!1),[j,k]=b.useState(a.likes_count);return e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-900/80 border border-gray-800 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full bg-gradient-to-br ${(null==(c=a.user)?void 0:c.avatar_color)||"from-cyan-500 to-blue-600"} flex items-center justify-center text-white font-bold`,children:(null==(g=null==(d=a.user)?void 0:d.username)?void 0:g.substring(0,2).toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-white",children:null==(N=a.user)?void 0:N.username}),e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-gray-800 rounded-full text-gray-400",children:["Niv. ",null==(v=a.user)?void 0:v.level]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:(e=>{const t=Math.floor(((new Date).getTime()-new Date(e).getTime())/1e3);return t<60?"À l'instant":t<3600?`${Math.floor(t/60)}min`:t<86400?`${Math.floor(t/3600)}h`:`${Math.floor(t/86400)}j`})(a.created_at)})]})]}),(()=>{var r,l;switch(a.type){case"result":return e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-gray-400 uppercase tracking-wider",children:a.category}),a.is_victory?e.jsxs("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm font-semibold flex items-center gap-1",children:[e.jsx(o,{className:"w-4 h-4"})," Victoire"]}):e.jsx("span",{className:"px-3 py-1 bg-red-500/20 text-red-400 rounded-full text-sm font-semibold",children:"Défaite"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:a.score}),e.jsx("div",{className:"text-sm text-gray-400",children:null==(r=a.user)?void 0:r.username})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:"VS"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:a.opponent_score||"-"}),e.jsx("div",{className:"text-sm text-gray-400",children:(null==(l=a.opponent)?void 0:l.username)||"Solo"})]})]})]});case"achievement":return e.jsxs("div",{className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center",children:e.jsx(f,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-400 font-semibold",children:"Achievement débloqué !"}),e.jsx("p",{className:"text-white text-lg font-bold",children:a.achievement_id})]})]});case"level_up":return e.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(p,{className:"w-6 h-6 text-cyan-400"}),e.jsx("span",{className:"text-cyan-400 font-semibold",children:"Level Up !"})]}),e.jsxs("div",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent",children:["Niveau ",a.new_level]})]});case"league_up":const s={bronze:"from-amber-600 to-amber-800",silver:"from-gray-300 to-gray-500",gold:"from-yellow-400 to-yellow-600",platinum:"from-cyan-300 to-cyan-500",diamond:"from-blue-400 to-purple-500",legend:"from-purple-500 to-pink-500"};return e.jsxs("div",{className:`bg-gradient-to-r ${s[a.new_league||"bronze"]}/20 rounded-xl p-4 text-center`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(u,{className:"w-6 h-6 text-yellow-400"}),e.jsx("span",{className:"text-yellow-400 font-semibold",children:"Promotion !"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white capitalize",children:["Ligue ",a.new_league]})]});case"challenge":return e.jsxs("div",{className:"bg-gradient-to-r from-red-500/20 to-orange-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(n,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400 font-semibold",children:"Défi lancé !"})]}),e.jsxs("p",{className:"text-white mb-3",children:["Qui peut me battre en ",e.jsx("span",{className:"font-bold text-cyan-400",children:a.challenge_category})," ?"]}),e.jsxs(y,{className:"w-full bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700",children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),"Relever le défi"]})]});case"streak":return e.jsxs("div",{className:"bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(i,{className:"w-6 h-6 text-orange-400"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:"Série en feu !"})]}),e.jsxs("div",{className:"text-4xl font-bold text-orange-400",children:[a.streak_count," victoires"]})]});default:return a.content?e.jsx("p",{className:"text-gray-300",children:a.content}):null}})(),e.jsxs("div",{className:"flex items-center gap-6 mt-4 pt-4 border-t border-gray-800",children:[e.jsxs("button",{onClick:()=>{_(!w),k(e=>w?e-1:e+1),r(a.id)},className:"flex items-center gap-2 transition-colors "+(w?"text-red-500":"text-gray-400 hover:text-red-400"),children:[e.jsx(m,{className:"w-5 h-5 "+(w?"fill-current":"")}),e.jsx("span",{children:j})]}),e.jsxs("button",{onClick:()=>s(a.id),className:"flex items-center gap-2 text-gray-400 hover:text-cyan-400 transition-colors",children:[e.jsx(h,{className:"w-5 h-5"}),e.jsx("span",{children:a.comments_count})]}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-400 hover:text-green-400 transition-colors",children:[e.jsx(x,{className:"w-5 h-5"}),e.jsx("span",{children:"Partager"})]})]})]})}function D({challenge:a,onAccept:r}){var s,n,i,c,o;return e.jsxs(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-br from-red-500/10 to-orange-500/10 border border-red-500/30 rounded-xl p-4 min-w-[280px]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-br ${(null==(s=a.challenger)?void 0:s.avatar_color)||"from-red-500 to-orange-600"} flex items-center justify-center text-white font-bold text-sm`,children:null==(i=null==(n=a.challenger)?void 0:n.username)?void 0:i.substring(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:null==(c=a.challenger)?void 0:c.username}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Niv. ",null==(o=a.challenger)?void 0:o.level]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Catégorie"}),e.jsx("p",{className:"font-bold text-white capitalize",children:a.category})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-xs text-orange-400",children:(()=>{const e=new Date(a.expires_at).getTime(),t=(new Date).getTime(),r=Math.floor((e-t)/36e5);return r<1?"Expire bientôt":`${r}h restantes`})()}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-800 rounded-full text-gray-400 capitalize",children:a.difficulty})]}),e.jsxs(y,{onClick:()=>r(a.id),className:"w-full bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700",size:"sm",children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),"Accepter"]})]})}function C(){var m;const h=g(),{user:x,profile:u}=v(),[p,f]=b.useState([]),[C,z]=b.useState([]),[A,$]=b.useState([]),[M,F]=b.useState(0),[L,P]=b.useState(!0),[Q,R]=b.useState(!1);b.useEffect(()=>{(async()=>{try{const[e,t]=await Promise.all([_.getFeed(20),j.getPublicChallenges(10)]);if(f(e),z(t),x){const[e,t]=await Promise.all([w.getNotifications(x.id,20),w.getUnreadCount(x.id)]);$(e),F(t)}}catch(e){}finally{P(!1)}})()},[x]),b.useEffect(()=>{if(!x)return;const e=w.subscribeToNotifications(x.id,e=>{$(t=>[e,...t]),F(e=>e+1)});return()=>{e.unsubscribe()}},[x]);const K=async e=>{if(x)try{const t=p.find(t=>t.id===e);(null==t?void 0:t.is_liked)?await _.unlikePost(e,x.id):await _.likePost(e,x.id)}catch(t){}},S=e=>{},U=async e=>{if(x)try{await j.acceptChallenge(e,x.id),h("/play")}catch(t){}},q=[{id:"1",user_id:"demo1",type:"result",category:"Rap",score:980,opponent_score:750,is_victory:!0,likes_count:24,comments_count:5,shares_count:2,is_public:!0,created_at:new Date(Date.now()-9e5).toISOString(),user:{id:"demo1",username:"KingQuiz243",avatar_color:"from-purple-500 to-pink-600",level:15,league:"gold"}},{id:"2",user_id:"demo2",type:"level_up",new_level:20,likes_count:45,comments_count:12,shares_count:0,is_public:!0,created_at:new Date(Date.now()-27e5).toISOString(),user:{id:"demo2",username:"ProdigyMaster",avatar_color:"from-cyan-500 to-blue-600",level:20,league:"platinum"}},{id:"3",user_id:"demo3",type:"challenge",challenge_category:"Football Africain",challenge_difficulty:"hard",likes_count:18,comments_count:8,shares_count:5,is_public:!0,created_at:new Date(Date.now()-72e5).toISOString(),user:{id:"demo3",username:"LeopardKin",avatar_color:"from-green-500 to-yellow-500",level:12,league:"silver"}},{id:"4",user_id:"demo4",type:"streak",streak_count:10,likes_count:67,comments_count:23,shares_count:8,is_public:!0,created_at:new Date(Date.now()-108e5).toISOString(),user:{id:"demo4",username:"FireQueen",avatar_color:"from-orange-500 to-red-600",level:25,league:"diamond"}},{id:"5",user_id:"demo5",type:"league_up",new_league:"gold",likes_count:89,comments_count:31,shares_count:12,is_public:!0,created_at:new Date(Date.now()-18e6).toISOString(),user:{id:"demo5",username:"ChampionRDC",avatar_color:"from-yellow-400 to-amber-600",level:18,league:"gold"}}],B=p.length>0?p:q;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-black/80 backdrop-blur-xl border-b border-cyan-500/20",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs(N,{to:"/",className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center",children:e.jsx(t,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent",children:"QQUIZ"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>R(!Q),className:"relative p-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(a,{className:"w-6 h-6"}),M>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs text-white flex items-center justify-center",children:M>9?"9+":M})]}),u?e.jsx(N,{to:"/profile",className:`w-10 h-10 rounded-full bg-gradient-to-br ${u.avatar_color} flex items-center justify-center text-white font-bold`,children:null==(m=u.username)?void 0:m.substring(0,2).toUpperCase()}):e.jsx(N,{to:"/auth",children:e.jsx(y,{size:"sm",className:"bg-gradient-to-r from-cyan-500 to-purple-600",children:"Connexion"})})]})]})}),e.jsx(r,{children:Q&&e.jsxs(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-16 right-4 z-50 w-80 bg-gray-900 border border-gray-800 rounded-xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Notifications"}),e.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-white",children:e.jsx(s,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:A.length>0?A.map(t=>e.jsxs("div",{className:"p-4 border-b border-gray-800 "+(t.is_read?"":"bg-cyan-500/5"),children:[e.jsx("p",{className:"text-sm text-gray-300",children:t.content||"Nouvelle notification"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(t.created_at).toLocaleString("fr-FR")})]},t.id)):e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Aucune notification"})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[C.length>0&&e.jsxs("section",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 text-red-400"}),"Défis ouverts"]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 -mx-4 px-4",children:C.map(t=>e.jsx(D,{challenge:t,onAccept:U},t.id))})]}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-orange-400"}),"Fil d'actualité"]}),L?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{children:B.map(t=>e.jsx(k,{post:t,onLike:K,onComment:S},t.id))})]})]}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-xl border-t border-gray-800 py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-around max-w-md mx-auto",children:[e.jsxs(N,{to:"/",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(c,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Accueil"})]}),e.jsxs(N,{to:"/feed",className:"flex flex-col items-center gap-1 text-cyan-400",children:[e.jsx(i,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Feed"})]}),e.jsx(N,{to:"/play",className:"flex flex-col items-center gap-1",children:e.jsx("div",{className:"w-14 h-14 -mt-6 rounded-full bg-gradient-to-r from-cyan-500 to-purple-600 flex items-center justify-center shadow-lg shadow-cyan-500/30",children:e.jsx(t,{className:"w-7 h-7 text-white"})})}),e.jsxs(N,{to:"/leaderboard",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(o,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Classement"})]}),e.jsxs(N,{to:"/profile",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(d,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Profil"})]})]})})]})}export{C as default};
