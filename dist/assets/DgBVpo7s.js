import{j as e,Z as v,K as M,A as I,m as D,X as O,T as $,F as S,H as Q,e as z,B as R,N as B,M as H,q as K,C as Z,g as q,f as V}from"./B678M3Go.js";import{u as X,r as i,L as d}from"./gFfKhp4p.js";import{B as P}from"./BLx6kmy3.js";import{u as G}from"./BuWSaeZB.js";import{n as k,f as C,c as A}from"./DHgiGZ_2.js";import"./DqliOerU.js";function J({post:t,onLike:a,onComment:x}){var o,y,w,b,N;const[n,f]=i.useState(t.is_liked||!1),[m,p]=i.useState(t.likes_count),u=()=>{f(!n),p(c=>n?c-1:c+1),a(t.id)},j=()=>{var c,l;switch(t.type){case"result":return e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-gray-400 uppercase tracking-wider",children:t.category}),t.is_victory?e.jsxs("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm font-semibold flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"})," Victoire"]}):e.jsx("span",{className:"px-3 py-1 bg-red-500/20 text-red-400 rounded-full text-sm font-semibold",children:"Défaite"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:t.score}),e.jsx("div",{className:"text-sm text-gray-400",children:(c=t.user)==null?void 0:c.username})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:"VS"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:t.opponent_score||"-"}),e.jsx("div",{className:"text-sm text-gray-400",children:((l=t.opponent)==null?void 0:l.username)||"Solo"})]})]})]});case"achievement":return e.jsxs("div",{className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center",children:e.jsx(V,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-400 font-semibold",children:"Achievement débloqué !"}),e.jsx("p",{className:"text-white text-lg font-bold",children:t.achievement_id})]})]});case"level_up":return e.jsxs("div",{className:"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(q,{className:"w-6 h-6 text-cyan-400"}),e.jsx("span",{className:"text-cyan-400 font-semibold",children:"Level Up !"})]}),e.jsxs("div",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent",children:["Niveau ",t.new_level]})]});case"league_up":const _={bronze:"from-amber-600 to-amber-800",silver:"from-gray-300 to-gray-500",gold:"from-yellow-400 to-yellow-600",platinum:"from-cyan-300 to-cyan-500",diamond:"from-blue-400 to-purple-500",legend:"from-purple-500 to-pink-500"};return e.jsxs("div",{className:`bg-gradient-to-r ${_[t.new_league||"bronze"]}/20 rounded-xl p-4 text-center`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(Z,{className:"w-6 h-6 text-yellow-400"}),e.jsx("span",{className:"text-yellow-400 font-semibold",children:"Promotion !"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white capitalize",children:["Ligue ",t.new_league]})]});case"challenge":return e.jsxs("div",{className:"bg-gradient-to-r from-red-500/20 to-orange-500/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:"text-red-400 font-semibold",children:"Défi lancé !"})]}),e.jsxs("p",{className:"text-white mb-3",children:["Qui peut me battre en ",e.jsx("span",{className:"font-bold text-cyan-400",children:t.challenge_category})," ?"]}),e.jsxs(P,{className:"w-full bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Relever le défi"]})]});case"streak":return e.jsxs("div",{className:"bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(S,{className:"w-6 h-6 text-orange-400"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:"Série en feu !"})]}),e.jsxs("div",{className:"text-4xl font-bold text-orange-400",children:[t.streak_count," victoires"]})]});default:return t.content?e.jsx("p",{className:"text-gray-300",children:t.content}):null}},h=c=>{const l=Math.floor((new Date().getTime()-new Date(c).getTime())/1e3);return l<60?"À l'instant":l<3600?`${Math.floor(l/60)}min`:l<86400?`${Math.floor(l/3600)}h`:`${Math.floor(l/86400)}j`};return e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-900/80 border border-gray-800 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full bg-gradient-to-br ${((o=t.user)==null?void 0:o.avatar_color)||"from-cyan-500 to-blue-600"} flex items-center justify-center text-white font-bold`,children:((w=(y=t.user)==null?void 0:y.username)==null?void 0:w.substring(0,2).toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-white",children:(b=t.user)==null?void 0:b.username}),e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-gray-800 rounded-full text-gray-400",children:["Niv. ",(N=t.user)==null?void 0:N.level]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:h(t.created_at)})]})]}),j(),e.jsxs("div",{className:"flex items-center gap-6 mt-4 pt-4 border-t border-gray-800",children:[e.jsxs("button",{onClick:u,className:`flex items-center gap-2 transition-colors ${n?"text-red-500":"text-gray-400 hover:text-red-400"}`,children:[e.jsx(B,{className:`w-5 h-5 ${n?"fill-current":""}`}),e.jsx("span",{children:m})]}),e.jsxs("button",{onClick:()=>x(t.id),className:"flex items-center gap-2 text-gray-400 hover:text-cyan-400 transition-colors",children:[e.jsx(H,{className:"w-5 h-5"}),e.jsx("span",{children:t.comments_count})]}),e.jsxs("button",{className:"flex items-center gap-2 text-gray-400 hover:text-green-400 transition-colors",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:"Partager"})]})]})]})}function W({challenge:t,onAccept:a}){var n,f,m,p,u;const x=()=>{const j=new Date(t.expires_at).getTime(),h=new Date().getTime(),o=Math.floor((j-h)/(1e3*60*60));return o<1?"Expire bientôt":`${o}h restantes`};return e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-br from-red-500/10 to-orange-500/10 border border-red-500/30 rounded-xl p-4 min-w-[280px]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-br ${((n=t.challenger)==null?void 0:n.avatar_color)||"from-red-500 to-orange-600"} flex items-center justify-center text-white font-bold text-sm`,children:(m=(f=t.challenger)==null?void 0:f.username)==null?void 0:m.substring(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:(p=t.challenger)==null?void 0:p.username}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Niv. ",(u=t.challenger)==null?void 0:u.level]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Catégorie"}),e.jsx("p",{className:"font-bold text-white capitalize",children:t.category})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-xs text-orange-400",children:x()}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-800 rounded-full text-gray-400 capitalize",children:t.difficulty})]}),e.jsxs(P,{onClick:()=>a(t.id),className:"w-full bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700",size:"sm",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Accepter"]})]})}function ne(){var L;const t=X(),{user:a,profile:x}=G(),[n,f]=i.useState([]),[m,p]=i.useState([]),[u,j]=i.useState([]),[h,o]=i.useState(0),[y,w]=i.useState(!0),[b,N]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const[r,g]=await Promise.all([C.getFeed(20),A.getPublicChallenges(10)]);if(f(r),p(g),a){const[T,E]=await Promise.all([k.getNotifications(a.id,20),k.getUnreadCount(a.id)]);j(T),o(E)}}catch(r){console.error("Erreur chargement feed:",r)}finally{w(!1)}})()},[a]),i.useEffect(()=>{if(!a)return;const s=k.subscribeToNotifications(a.id,r=>{j(g=>[r,...g]),o(g=>g+1)});return()=>{s.unsubscribe()}},[a]);const c=async s=>{if(a)try{const r=n.find(g=>g.id===s);r!=null&&r.is_liked?await C.unlikePost(s,a.id):await C.likePost(s,a.id)}catch(r){console.error("Erreur like:",r)}},l=s=>{console.log("Comment on post:",s)},_=async s=>{if(a)try{await A.acceptChallenge(s,a.id),t("/play")}catch(r){console.error("Erreur acceptation défi:",r)}},U=[{id:"1",user_id:"demo1",type:"result",category:"Rap",score:980,opponent_score:750,is_victory:!0,likes_count:24,comments_count:5,shares_count:2,is_public:!0,created_at:new Date(Date.now()-1e3*60*15).toISOString(),user:{id:"demo1",username:"KingQuiz243",avatar_color:"from-purple-500 to-pink-600",level:15,league:"gold"}},{id:"2",user_id:"demo2",type:"level_up",new_level:20,likes_count:45,comments_count:12,shares_count:0,is_public:!0,created_at:new Date(Date.now()-1e3*60*45).toISOString(),user:{id:"demo2",username:"ProdigyMaster",avatar_color:"from-cyan-500 to-blue-600",level:20,league:"platinum"}},{id:"3",user_id:"demo3",type:"challenge",challenge_category:"Football Africain",challenge_difficulty:"hard",likes_count:18,comments_count:8,shares_count:5,is_public:!0,created_at:new Date(Date.now()-1e3*60*120).toISOString(),user:{id:"demo3",username:"LeopardKin",avatar_color:"from-green-500 to-yellow-500",level:12,league:"silver"}},{id:"4",user_id:"demo4",type:"streak",streak_count:10,likes_count:67,comments_count:23,shares_count:8,is_public:!0,created_at:new Date(Date.now()-1e3*60*180).toISOString(),user:{id:"demo4",username:"FireQueen",avatar_color:"from-orange-500 to-red-600",level:25,league:"diamond"}},{id:"5",user_id:"demo5",type:"league_up",new_league:"gold",likes_count:89,comments_count:31,shares_count:12,is_public:!0,created_at:new Date(Date.now()-1e3*60*300).toISOString(),user:{id:"demo5",username:"ChampionRDC",avatar_color:"from-yellow-400 to-amber-600",level:18,league:"gold"}}],F=n.length>0?n:U;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-black/80 backdrop-blur-xl border-b border-cyan-500/20",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs(d,{to:"/",className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center",children:e.jsx(v,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent",children:"QQUIZ"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>N(!b),className:"relative p-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(M,{className:"w-6 h-6"}),h>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs text-white flex items-center justify-center",children:h>9?"9+":h})]}),x?e.jsx(d,{to:"/profile",className:`w-10 h-10 rounded-full bg-gradient-to-br ${x.avatar_color} flex items-center justify-center text-white font-bold`,children:(L=x.username)==null?void 0:L.substring(0,2).toUpperCase()}):e.jsx(d,{to:"/auth",children:e.jsx(P,{size:"sm",className:"bg-gradient-to-r from-cyan-500 to-purple-600",children:"Connexion"})})]})]})}),e.jsx(I,{children:b&&e.jsxs(D.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-16 right-4 z-50 w-80 bg-gray-900 border border-gray-800 rounded-xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Notifications"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-white",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:u.length>0?u.map(s=>e.jsxs("div",{className:`p-4 border-b border-gray-800 ${s.is_read?"":"bg-cyan-500/5"}`,children:[e.jsx("p",{className:"text-sm text-gray-300",children:s.content||"Nouvelle notification"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.created_at).toLocaleString("fr-FR")})]},s.id)):e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Aucune notification"})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[m.length>0&&e.jsxs("section",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-red-400"}),"Défis ouverts"]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 -mx-4 px-4",children:m.map(s=>e.jsx(W,{challenge:s,onAccept:_},s.id))})]}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-orange-400"}),"Fil d'actualité"]}),y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{children:F.map(s=>e.jsx(J,{post:s,onLike:c,onComment:l},s.id))})]})]}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-xl border-t border-gray-800 py-2 px-4",children:e.jsxs("div",{className:"flex items-center justify-around max-w-md mx-auto",children:[e.jsxs(d,{to:"/",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(Q,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Accueil"})]}),e.jsxs(d,{to:"/feed",className:"flex flex-col items-center gap-1 text-cyan-400",children:[e.jsx(S,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Feed"})]}),e.jsx(d,{to:"/play",className:"flex flex-col items-center gap-1",children:e.jsx("div",{className:"w-14 h-14 -mt-6 rounded-full bg-gradient-to-r from-cyan-500 to-purple-600 flex items-center justify-center shadow-lg shadow-cyan-500/30",children:e.jsx(v,{className:"w-7 h-7 text-white"})})}),e.jsxs(d,{to:"/leaderboard",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(z,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Classement"})]}),e.jsxs(d,{to:"/profile",className:"flex flex-col items-center gap-1 text-gray-400 hover:text-white transition-colors",children:[e.jsx(R,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:"Profil"})]})]})})]})}export{ne as default};
