const e=e=>Math.floor(100*Math.pow(1.5,e-1)),a=[{id:"first_victory",name:"Première Victoire",description:"Gagne ta première partie",image:"/images/achievements/Achiev_Premiere_Victoire.png",target:1},{id:"10_victories",name:"10 Victoires",description:"Gagne 10 parties",image:"/images/achievements/Achiev_10_Victoires.png",target:10},{id:"100_questions",name:"100 Questions",description:"Réponds à 100 questions",image:"/images/achievements/Achiev_100_Questions.png",target:100},{id:"perfect_series",name:"Série Parfaite",description:"10 bonnes réponses consécutives",image:"/images/achievements/Achiev_Serie_Parfaite.png",target:10},{id:"quiz_master",name:"Quiz Master",description:"Atteins 90% de précision sur 50 questions",image:"/images/achievements/Achiev_Premiere_Victoire.png",target:50},{id:"speed_demon",name:"Speed Demon",description:"Réponds en moins de 3 secondes 20 fois",image:"/images/achievements/Achiev_10_Victoires.png",target:20},{id:"category_expert",name:"Expert Catégorie",description:"Atteins 100% sur une catégorie (10 questions)",image:"/images/achievements/Achiev_100_Questions.png",target:1},{id:"social_butterfly",name:"Papillon Social",description:"Joue 5 duels contre des amis",image:"/images/achievements/Achiev_Serie_Parfaite.png",target:5}],t=[{id:"PM",name:"Prodigy Master"},{id:"QK",name:"Quiz King"},{id:"BS",name:"Brain Storm"},{id:"QN",name:"Quiz Ninja"},{id:"MR",name:"Mind Reader"},{id:"GN",name:"Genius"},{id:"WZ",name:"Wizard"},{id:"CH",name:"Champion"}],i=["from-violet-600 to-fuchsia-600","from-cyan-500 to-blue-600","from-green-500 to-emerald-600","from-orange-500 to-red-600","from-pink-500 to-rose-600","from-indigo-500 to-purple-600","from-yellow-500 to-amber-600","from-teal-500 to-cyan-600"],r=r=>{const s=t[Math.floor(Math.random()*t.length)],n=i[Math.floor(Math.random()*i.length)],o=a.map(e=>({...e,unlocked:!1,progress:0}));return{id:`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,username:r,avatar:s.id,avatarColor:n,level:1,xp:0,xpToNextLevel:e(1),totalXp:0,league:"bronze",leaguePoints:0,stats:{totalGames:0,wins:0,losses:0,draws:0,winRate:0,totalQuestions:0,correctAnswers:0,accuracy:0,bestStreak:0,currentStreak:0,totalPlayTime:0,favoriteCategory:"",categoryStats:{}},achievements:o,createdAt:(new Date).toISOString(),lastPlayedAt:(new Date).toISOString()}},s=e=>{localStorage.setItem("qquiz_user",JSON.stringify(e))},n=()=>{const e=localStorage.getItem("qquiz_user");if(!e)return null;try{return JSON.parse(e)}catch{return null}},o=(a,t)=>{const i={...a},r={...i.stats};r.totalGames++,r.totalQuestions+=t.totalQuestions,r.correctAnswers+=t.correctAnswers,r.accuracy=Math.round(r.correctAnswers/r.totalQuestions*100),r.totalPlayTime+=t.timeSpent,t.isWin?(r.wins++,r.currentStreak++,r.currentStreak>r.bestStreak&&(r.bestStreak=r.currentStreak)):(r.losses++,r.currentStreak=0),r.winRate=Math.round(r.wins/r.totalGames*100),r.categoryStats[t.category]||(r.categoryStats[t.category]={played:0,correct:0,accuracy:0,bestScore:0});const s=r.categoryStats[t.category];s.played+=t.totalQuestions,s.correct+=t.correctAnswers,s.accuracy=Math.round(s.correct/s.played*100),t.score>s.bestScore&&(s.bestScore=t.score);let n=0;Object.entries(r.categoryStats).forEach(([e,a])=>{a.played>n&&(n=a.played,r.favoriteCategory=e)}),i.stats=r;const o=t.score/10,g=t.isWin?50:10,m=Math.min(5*r.currentStreak,50),d=Math.floor(o+g+m);i.totalXp+=d;const l=(a=>{let t=1,i=e(t),r=a;for(;r>=i;)r-=i,t++,i=e(t);return{level:t,currentXp:r,xpToNext:i}})(i.totalXp);i.level=l.level,i.xp=l.currentXp,i.xpToNextLevel=l.xpToNext;const u=t.isWin?25:t.isDuel?-10:5;var p;return i.leaguePoints=Math.max(0,i.leaguePoints+u),i.league=(p=i.leaguePoints)>=1e4?"legend":p>=5e3?"diamond":p>=2500?"platinum":p>=1e3?"gold":p>=500?"silver":"bronze",i.achievements=c(i,t),i.lastPlayedAt=(new Date).toISOString(),i},c=(e,a)=>e.achievements.map(t=>{if(t.unlocked)return t;let i=t.progress;switch(t.id){case"first_victory":a.isWin&&(i=1);break;case"10_victories":a.isWin&&(i=e.stats.wins);break;case"100_questions":i=e.stats.totalQuestions;break;case"perfect_series":a.correctAnswers===a.totalQuestions&&(i=Math.max(i,a.totalQuestions));break;case"quiz_master":e.stats.accuracy>=90&&e.stats.totalQuestions>=50&&(i=50);break;case"category_expert":a.correctAnswers===a.totalQuestions&&a.totalQuestions>=10&&(i=1)}const r=i>=t.target;return{...t,progress:i,unlocked:r,unlockedAt:r&&!t.unlocked?(new Date).toISOString():t.unlockedAt}}),g=e=>({bronze:"/images/badges/Badge_Bronze.png",silver:"/images/badges/Badge_Argent.png",gold:"/images/badges/Badge_Or.png",platinum:"/images/badges/Badge_Platine.png",diamond:"/images/badges/Badge_Diamant.png",legend:"/images/badges/Badge_Legende.png"}[e]),m=e=>({bronze:"Bronze",silver:"Argent",gold:"Or",platinum:"Platine",diamond:"Diamant",legend:"Légende"}[e]),d=e=>{const a=Math.floor(e/3600),t=Math.floor(e%3600/60);return a>0?`${a}h ${t}m`:`${t}m`};export{t as A,m as a,i as b,r as c,d as f,g,n as l,s,o as u};
